var F=Object.defineProperty,I=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var E=(e,a,t)=>a in e?F(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,L=(e,a)=>{for(var t in a||(a={}))K.call(a,t)&&E(e,t,a[t]);if(C)for(var t of C(a))q.call(a,t)&&E(e,t,a[t]);return e},S=(e,a)=>I(e,U(a));var T=(e,a,t)=>new Promise((d,c)=>{var h=o=>{try{u(t.next(o))}catch(l){c(l)}},r=o=>{try{u(t.throw(o))}catch(l){c(l)}},u=o=>o.done?d(o.value):Promise.resolve(o.value).then(h,r);u((t=t.apply(e,a)).next())});import{b3 as j,aX as z,aW as n,b5 as D,aY as G,b6 as Y,ax as O,b7 as Q,b8 as W,b4 as y}from"./bootstrap-DeLwhWm9.js";import X from"./captcha-input-DbY1jZ0i.js";import{T as H}from"./auth-title-BfKsh0IA.js";import{a1 as $,P as J,E as B,L as x,aa as Z,ap as M,aj as p,al as v,p as P,an as _,ak as g,ax as w,ay as f,a9 as s,az as V,ai as N,aR as ee,M as te}from"../jse/index-index-DnNrpD3V.js";const ae=["onKeydown"],oe={class:"text-muted-foreground"},ne={key:0,class:"mb-6 flex justify-between"},se={class:"flex-center"},ie=$({name:"AuthenticationLogin",__name:"login",props:{formSchema:{default:()=>[]},codeLoginPath:{default:"/auth/code-login"},forgetPasswordPath:{default:"/auth/forget-password"},loading:{type:Boolean,default:!1},qrCodeLoginPath:{default:"/auth/qrcode-login"},registerPath:{default:"/auth/register"},showCodeLogin:{type:Boolean,default:!0},showForgetPassword:{type:Boolean,default:!0},showQrcodeLogin:{type:Boolean,default:!0},showRegister:{type:Boolean,default:!0},showRememberMe:{type:Boolean,default:!0},showThirdPartyLogin:{type:Boolean,default:!0},subTitle:{default:""},title:{default:""},submitButtonText:{default:""}},emits:["submit"],setup(e,{expose:a,emit:t}){const d=e,c=t,[h,r]=j(J({commonConfig:{hideLabel:!0,hideRequiredMark:!0},schema:B(()=>d.formSchema),showDefaultActions:!1})),u=z(),o=`REMEMBER_ME_USERNAME_${location.hostname}`,l=localStorage.getItem(o)||"",b=x(!!l);function k(){return T(this,null,function*(){const{valid:m}=yield r.validate(),i=yield r.getValues();m&&(localStorage.setItem(o,b.value?i==null?void 0:i.username:""),c("submit",i))})}function A(m){u.push(m)}return Z(()=>{l&&r.setFieldValue("username",l)}),a({getFormApi:()=>r}),(m,i)=>(p(),M("div",{onKeydown:Y(O(k,["prevent"]),["enter"])},[v(m.$slots,"title",{},()=>[P(H,null,{desc:g(()=>[V("span",oe,[v(m.$slots,"subTitle",{},()=>[w(f(e.subTitle||s(n)("authentication.loginSubtitle")),1)])])]),default:g(()=>[v(m.$slots,"title",{},()=>[w(f(e.title||`${s(n)("authentication.welcomeBack")} ðŸ‘‹ðŸ»`),1)])]),_:3})]),P(s(h)),e.showRememberMe||e.showForgetPassword?(p(),M("div",ne,[V("div",se,[e.showRememberMe?(p(),N(s(D),{key:0,modelValue:b.value,"onUpdate:modelValue":i[0]||(i[0]=R=>b.value=R),name:"rememberMe"},{default:g(()=>[w(f(s(n)("authentication.rememberMe")),1)]),_:1},8,["modelValue"])):_("",!0)]),e.showForgetPassword?(p(),M("span",{key:0,class:"vben-link text-sm font-normal",onClick:i[1]||(i[1]=R=>A(e.forgetPasswordPath))},f(s(n)("authentication.forgetPassword")),1)):_("",!0)])):_("",!0),P(s(G),{class:ee([{"cursor-wait":e.loading},"w-full"]),loading:e.loading,"aria-label":"login",onClick:k},{default:g(()=>[w(f(e.submitButtonText||s(n)("common.login")),1)]),_:1},8,["class","loading"])],40,ae))}}),re={VITE_GLOB_API_URL:"https://user.api.it120.cc/"},he=$({name:"Login",__name:"login",setup(e){const a=Q(),t=x(Math.random()),{apiURL:d}=W(re,!0),c=B(()=>`${d}/code?k=${t.value}`);function h(){t.value=Math.random()}const r=B(()=>[{component:"VbenInput",componentProps:{placeholder:n("authentication.usernameTip")},fieldName:"userName",label:n("authentication.username"),rules:y().min(1,{message:n("authentication.usernameTip")})},{component:"VbenInputPassword",componentProps:{placeholder:n("authentication.password")},fieldName:"pwd",label:n("authentication.password"),rules:y().min(1,{message:n("authentication.passwordTip")})},{component:te(X),componentProps:{placeholder:"è¯·è¾“å…¥éªŒè¯ç ",src:c.value,onClickCaptcha:h},fieldName:"imgcode",label:"éªŒè¯ç ",rules:y().min(1,{message:"è¯·è¾“å…¥éªŒè¯ç "})}]);function u(o){return a.authLogin(S(L({},o),{k:t.value,pdomain:"96789",rememberMe:!0}))}return(o,l)=>(p(),N(s(ie),{"form-schema":r.value,loading:s(a).loginLoading,"show-forget-password-btn":!1,"show-register-btn":!1,"show-third-party-login":!1,onSubmit:u},null,8,["form-schema","loading"]))}});export{he as _};
