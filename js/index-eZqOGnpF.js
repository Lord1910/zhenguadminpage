var U=Object.defineProperty,D=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var w=(i,l,t)=>l in i?U(i,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[l]=t,I=(i,l)=>{for(var t in l||(l={}))R.call(l,t)&&w(i,t,l[t]);if(T)for(var t of T(l))j.call(l,t)&&w(i,t,l[t]);return i},$=(i,l)=>D(i,E(l));var C=(i,l,t)=>new Promise((y,x)=>{var v=d=>{try{g(t.next(d))}catch(o){x(o)}},k=d=>{try{g(t.throw(d))}catch(o){x(o)}},g=d=>d.done?y(d.value):Promise.resolve(d.value).then(v,k);g((t=t.apply(i,l)).next())});import{u as L,T as M}from"./vxe-table-Cfs8RsgE.js";import{bH as q,Y as P}from"./bootstrap-BTIPnWWv.js";import{T as G,a as u}from"./index-B4DjCwrH.js";import{T as H}from"./index-D9tcRslk.js";import{_ as V}from"./page.vue_vue_type_script_setup_true_lang-oiof0xwk.js";import{a1 as W,L as K,P as Y,ai as z,aj as f,ak as n,az as a,p,a9 as r,ay as s,ap as h,ax as _,an as F}from"../jse/index-index-BrQDROG1.js";import"./TextArea-CW-aWovf.js";import"./vnode-DVc8J38a.js";import"./FormItemContext-2PfnUQmV.js";import"./statusUtils-CjRZ0o_v.js";import"./index-AqOL_jkC.js";import"./ResizeObserver.es-CDE7jhPe.js";import"./BaseInput-BBrjlWaR.js";import"./css-BPcmMxJM.js";import"./index-Bxx8_ENb.js";import"./index-D8JALBAF.js";import"./Trigger-C5FCCO2n.js";import"./colors-D3jdjhsM.js";import"./CheckOutlined-Db8MjDQ5.js";import"./useMergedState-DlhauTXM.js";import"./index-DtvceY3-.js";import"./EyeOutlined-BBP8xmxz.js";import"./index-Vbjq189s.js";import"./shallowequal-j-zk1ur5.js";import"./Overflow-Bon2qXVT.js";import"./collapseMotion-BhmgkaKM.js";import"./slide-FhZff9ea.js";import"./collapse-BbEVqHco.js";import"./useRefs-DzwTW3te.js";import"./hasIn-UKWfMhN3.js";import"./isMobile-8sZ0LT6r.js";function J(i){return C(this,null,function*(){return q.post("/user/apiExtOrder/list",i,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})})}const Q={class:"mb-4 bg-white px-4 pt-2 dark:bg-[#151515]"},X={class:"mb-2 rounded bg-green-50 p-2 text-sm text-green-700 dark:bg-green-900/20 dark:text-green-400"},Z=["src"],ee={key:1,class:"flex h-12 w-12 items-center justify-center rounded bg-gray-100 text-xs text-gray-400"},te={class:"flex flex-col text-xs"},ae={class:"flex flex-col text-xs"},le={class:"text-gray-500"},oe={class:"flex flex-col items-start gap-1"},se={class:"flex flex-col text-xs"},ne={class:"text-gray-500"},re={class:"flex flex-col text-xs"},ie={class:"text-gray-500"},de={class:"flex flex-col text-xs text-gray-500"},pe={class:"flex flex-wrap gap-2"},ce={key:0,class:"bg-gray-50 px-12 py-2 text-xs text-gray-600 dark:bg-gray-800/50"},ue={key:1,class:"bg-gray-50 px-12 py-2 text-xs text-gray-400 dark:bg-gray-800/50"},We=W({__name:"index",setup(i){const l=K("all"),t=Y({count_id:0,sum_amount_real:0,sum_goods_number:0,sum_money_refund:0}),y={collapsed:!0,schema:[{component:"Select",fieldName:"type",label:"订单类型",componentProps:{allowClear:!0,options:[{label:"普通订单",value:"0"},{label:"周期性订阅",value:"1"},{label:"扫码点餐",value:"2"}],placeholder:"订单类型"}},{component:"Input",fieldName:"goodsName",label:"商品名称",componentProps:{placeholder:"商品名称"}},{component:"Input",fieldName:"shopId",label:"所属门店",componentProps:{placeholder:"门店ID"}},{component:"Input",fieldName:"mobile",label:"手机号",componentProps:{placeholder:"下单用户手机号"}},{component:"Input",fieldName:"nick",label:"昵称",componentProps:{placeholder:"下单用户昵称"}},{component:"Input",fieldName:"orderNumber",label:"订单号",componentProps:{placeholder:"订单号"}},{component:"Select",fieldName:"status",label:"状态",componentProps:{allowClear:!0,options:[{label:"关闭订单",value:"-1"},{label:"待支付",value:"0"},{label:"已支付待发货",value:"1"},{label:"已发货待确认",value:"2"},{label:"确认收货待评价",value:"3"},{label:"已评价",value:"4"}],placeholder:"状态"}},{component:"Select",fieldName:"refundStatus",label:"退款状态",componentProps:{allowClear:!0,options:[{label:"无退款",value:"0"},{label:"有退款",value:"1"},{label:"退款中",value:"2"},{label:"退款成功",value:"3"},{label:"退款待处理",value:"4"}],placeholder:"退款状态"}},{component:"RangePicker",fieldName:"dateAdd",label:"下单时间"},{component:"RangePicker",fieldName:"dateUpdate",label:"更新时间"},{component:"Input",fieldName:"goodsId",label:"商品ID",componentProps:{placeholder:"商品ID"}},{component:"Input",fieldName:"sellerMobile",label:"分销商手机",componentProps:{placeholder:"分销商手机"}},{component:"Input",fieldName:"trackingNumber",label:"快递单号",componentProps:{placeholder:"快递单号"}},{component:"Input",fieldName:"shipperCode",label:"快递公司编码",componentProps:{placeholder:"快递公司编码"}},{component:"Select",fieldName:"isNeedLogistics",label:"是否快递",componentProps:{allowClear:!0,options:[{label:"是",value:"true"},{label:"否",value:"false"}],placeholder:"是否需要发快递"}}],showCollapseButton:!0,submitOnChange:!1,submitOnEnter:!0},x={columns:[{type:"checkbox",width:50},{type:"expand",width:40,slots:{content:"expand_content"}},{title:"头像",width:80,slots:{default:"avatar"}},{title:"用户信息",minWidth:200,slots:{default:"userInfo"}},{title:"下单IP",field:"ip",width:120},{title:"商品数/订单号",minWidth:220,slots:{default:"orderInfo"}},{title:"状态",width:100,slots:{default:"status"}},{title:"价格",width:120,slots:{default:"price"}},{title:"实收金额",width:120,slots:{default:"realAmount"}},{title:"交易时间/更新时间",width:180,slots:{default:"time"}},{title:"操作",slots:{default:"action"},width:150,fixed:"right"}],exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{enabled:!0},expandConfig:{expandAll:!0,padding:!1},proxyConfig:{ajax:{query:(e,b)=>C(null,[e,b],function*({page:d},o){try{const c=I({page:d.currentPage,pageSize:d.pageSize},o);l.value!=="all"&&(c.status=l.value),o.dateAdd&&o.dateAdd.length===2&&(c.dateAddBegin=`${o.dateAdd[0]} 00:00:00`,c.dateAddEnd=`${o.dateAdd[1]} 23:59:59`,delete c.dateAdd);const m=yield J(c);return m.aggregate&&Object.assign(t,m.aggregate),{items:m.result.map(N=>{var S,A;const B=((S=m.apiExtUserMap)==null?void 0:S[String(N.uid)])||{},O=((A=m.logisticsMap)==null?void 0:A[String(N.id)])||{};return $(I({},N),{userInfo:B,logistics:O})}),total:m.totalRow}}catch(c){return console.error(c),{items:[],total:0}}})}},toolbarConfig:{custom:!0,export:!0,refresh:!0,resizable:!0,search:!0,zoom:!0},rowConfig:{height:120,isHover:!0}},[v,k]=L({formOptions:y,gridOptions:x});function g(d){l.value=d,k.query()}return(d,o)=>(f(),z(r(V),{"auto-content-height":""},{default:n(()=>[a("div",Q,[p(r(G),{"active-key":l.value,"onUpdate:activeKey":o[0]||(o[0]=e=>l.value=e),onChange:g},{default:n(()=>[p(r(u),{key:"all",tab:"全部"}),p(r(u),{key:"-1",tab:"已关闭"}),p(r(u),{key:"0",tab:"待支付"}),p(r(u),{key:"1",tab:"待发货"}),p(r(u),{key:"2",tab:"已发货"}),p(r(u),{key:"3",tab:"待评价"}),p(r(u),{key:"4",tab:"已完成"})]),_:1},8,["active-key"]),a("div",X," 搜索结果统计：共 "+s(t.count_id)+" 笔订单， 共 "+s(t.sum_goods_number)+" 件商品， 累计订单金额 "+s(t.sum_amount_real)+" 元， 退款金额 "+s(t.sum_money_refund)+" 元 ",1)]),p(r(v),null,{avatar:n(({row:e})=>{var b;return[(b=e.userInfo)!=null&&b.avatarUrl?(f(),h("img",{key:0,src:e.userInfo.avatarUrl,class:"h-12 w-12 rounded",alt:""},null,8,Z)):(f(),h("div",ee," 无图 "))]}),userInfo:n(({row:e})=>{var b,c;return[a("div",te,[a("span",null,"用户编号: "+s(e.uid),1),a("span",null,"手机号: "+s(((b=e.userInfo)==null?void 0:b.mobile)||"-"),1),a("span",null,"昵称: "+s(((c=e.userInfo)==null?void 0:c.nick)||"-"),1)])]}),orderInfo:n(({row:e})=>[a("div",ae,[a("span",null,"共 "+s(e.goodsNumber)+" 件商品",1),a("span",le,s(e.orderNumber),1)])]),status:n(({row:e})=>[a("div",oe,[a("span",null,s(e.statusStr),1),e.hasRefund?(f(),z(r(H),{key:0,color:"red",class:"mr-0 text-xs"},{default:n(()=>[...o[1]||(o[1]=[_(" 有退款 ",-1)])]),_:1})):F("",!0)])]),price:n(({row:e})=>[a("div",se,[a("span",null,"商品金额: "+s(e.amount),1),a("span",ne,"快递费: "+s(e.amountLogistics),1)])]),realAmount:n(({row:e})=>[a("div",re,[a("span",null,"金额: "+s(e.amountReal),1),a("span",ie,"积分: "+s(e.score),1)])]),time:n(({row:e})=>[a("div",de,[a("span",null,s(e.dateAdd),1),a("span",null,s(e.dateUpdate),1)])]),action:n(({row:e})=>[a("div",pe,[p(r(P),{type:"link",size:"small",class:"p-0"},{default:n(()=>[_(" 查看 "+s(e.statusStr),1)]),_:2},1024),p(r(P),{type:"link",size:"small",class:"p-0"},{default:n(()=>[...o[2]||(o[2]=[_("备注",-1)])]),_:1}),p(r(P),{type:"link",size:"small",class:"p-0 text-red-500"},{default:n(()=>[...o[3]||(o[3]=[_(" 删除 ",-1)])]),_:1})])]),expand_content:n(({row:e})=>[e.logistics?(f(),h("div",ce,[p(r(M).Text,{copyable:"",content:`${e.logistics.linkMan},${e.logistics.mobile},${e.logistics.provinceStr}${e.logistics.cityStr}${e.logistics.areaStr}${e.logistics.address}`,class:"ml-2 !text-xs !text-blue-500"},null,8,["content"])])):(f(),h("div",ue," 暂无物流/地址信息 "))]),_:1})]),_:1}))}});export{We as default};
